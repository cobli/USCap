# USCap
MSKLCを使ったWindows用のカスタム言語キーボードです。通常のUSキーボードと同じように使えます。  
CapsLockを押した時は英大文字になります。

## インストール方法その壱
リリースされている Setup Package を利用します。
1. [プロジェクトのページ](https://github.com/cobli/USCap/)に行きます。
2. `Releases`をクリックし、出てきた`uscap.zip`をクリックすると、Setup Package がダウンロードされます。
3. ダウンロードしたZIPファイルを展開します。
4. その uscap のフォルダを **適切な場所に移動※** します。
5. uscap フォルダの中にある setup.exe をダブルクリックします。
6. 指示に従っていくと WindowsPC に cobli/github.io/USCap/ という名前で言語キーボードがインストールされます。
7. WindowsPC を再起動すると、その言語キーボードが使えるようになります。

※インストール後に uscap フォルダを移動させたり消去すると、USCapキーボードのアンインストールが出来なくなります。

## インストール方法その弐
MSKLCを使い、自分でソースコードから Setup Package をビルドする方法です。ソースコードは自分で変更して好みに合わせる事が可能になります。  
1. MicrosoftのWebページから、[MSKLC のプログラム](https://www.microsoft.com/en-us/download/details.aspx?id=102134)をダウンロードして、WindowsPC にインストールします。
2. [プロジェクトのページ](https://github.com/cobli/USCap/)に行きます。
3. `Releases`をクリックし、出てきた`USCap.klc`をクリックすると、ソースコードがダウンロードされます。
4. ダウンロードした USCap.klc をダブルクリックすると、MSKLC のプログラムが起動します。
5. MSKLC の Project タブを選択し、その中から Build DLL and Setup Package を選択します。
6. 指示に従っていくと uscap という名前のフォルダで Setup Package が出来ます。その後は「方法その壱」の 4. 以下を実行します。

## 日本語IME と共に
日本語IME用のキーボードドライバとして日本語キーボードやUSキーボードが指定されている場合、
日本語IMEがOnの時には様々な記号が入力出来るのですが、Offした途端にASCII印刷可能文字の範囲でしか入力出来なくなってしまいます。

しかし、このUSCapキーボードを日本語IME用のキーボードドライバに指定していれば、日本語IMEがOffの時でもASCII印刷可能文字に加え、
文字実体参照(HTML 4.01で定義)の記号※が入力可能になります。  
更に、シンボル用ギリシャ文字、上付き・下付き文字、アクセント記号付きのラテン文字(独自追加分)の入力も可能です。
> ※例外的に入力出来ない記号のリスト
> 1. ソフトハイフン `&shy;`
> 2. スペース系 `&ensp;` `&emsp;` `&thinsp;`
> 3. 合字の制御 `&zwnj;` `&zwj;`
> 4. 文字の方向性制御 `&lrm;` `&rlm;`

## デメリット
このUSCapキーボードを日本語IME用のキーボードドライバに指定した場合には幾つかの制限が生じます。
1. 右AltキーをAltgrキーとして定義しています。この為、通常のAltキーとして機能するのは左Altキーのみになります。
2. Ctrl + Alt + 文字キー というショートカットキーが使えなくなります。
3. Shift + Space というショートカットキーが使えなくなります。(ブラウザのスクロール等)
4. Shiftキーを押して入力する文字の間にSpaceが挟まる場合に、Shiftキーを押したままで入力出来なくなります。

## USCapキーボードを日本語IME用のキーボードドライバに指定する方法
ThinkPad USキーボード 以外は確認してません。自己責任でお願いします。
1. [プロジェクトのページ](https://github.com/cobli/USCap/)に行きます。
2. `Releases`をクリックし、出てきた `Key_Layout_411_Cap.reg` をクリックすると、レジストリ変更ファイル がダウンロードされます。
4. ダウンロードした Key_Layout_411_Cap.reg をダブルクリックすると、レジストリエディタが起動します。
3. 変更許可の確認ウインドウの `はい` のボタンを押してレジストリを書き換えます。
4.  WindowsPC を再起動すると、USCapキーボードが日本語IME用のキーボードになります。
5.  同様にして、`Key_Layout_411_US.reg` を使ってレジストリを書き換えれば、日本語IME用のキーボードドライバは通常のUSキーボードに戻ります。

## 日本語キーボードでのUSCapキーボードの利用
日本語キーボードでもUSCapキーボードは利用できますが、幾つかの問題点があります。
1. 日本語キーボード固有のキーが使えないので、日本語IMEを使うときに不便になる可能性があります。  
2. 幾つかの記号でキートップの印字が合いません。しかし、キートップにUSキーボード用のシールを貼ることで解決する方法があります。
3. 日本語IME用のキーボードドライバをUSCapキーボードにした後で日本語キーボードに戻せるのか確認してません。






